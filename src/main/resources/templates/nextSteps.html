<div th:fragment="nextSteps"
     th:with="contactEmail=${data.getPageInputFirstValue('contactInfo', 'email')},
              enhanced-next-steps=1">
  <div class="grid__item spacing-below-15">
    <div th:replace="~{fragments/icons/icon-next-steps-filled :: icon-next-steps-filled}"></div>
  </div>
  <div class="grid__item">
    <h1 class="h2 spacing-below-15 spacing-above-0" th:text="#{next-steps.title}"></h1>
  </div>
  
  <div class="grid__item width-one-whole spacing-below-25 text--small">
    <!-- original nextSteps content -->
    <div class="next-steps" id="original-next-steps"
         th:if="${not @environment.getProperty('feature-flag.enhanced-next-steps') and nextStepSections.size() > 0}">
 
      <th:block th:each="msg: ${nextStepSections}">
        <div class="grid-ignore-mobile notice--shiba spacing-below-35">
          <div class="success-icons grid__item width-one-sixth">
            <div th:replace="~{__${msg.icon()}__}"
                 class="success-icons text--centered width-one-whole"></div>
          </div>
          <p class="grid__item width-five-sixths next-step-section"
             th:utext="${msg.message()}"></p>
        </div>
      </th:block>
    </div>
    
    <!-- new nextSteps content -->
    <div th:if="${@environment.getProperty('feature-flag.enhanced-next-steps')}">
		<div class="grid__item">
        	<p class="spacing-below-35 next-steps-text spacing-above-0" th:text="#{next-steps.open-each-step}"></p>
    	</div>
    	<!-- design requires the first accordion to appear closed (i.e., have no expanded text) and have the +/- hidden -->
		<div class="accordion next-steps-alt-accordion hidden-accordion spacing-below-20" id="next-steps-accordion">
			<button href="#" class="accordion__button hidden-accordion__button" aria-expanded="false" aria-controls="a1">
				<div id="process-step-1" class="grid__item width-twelve-twelfths">
					<div class="grid__item width-twenty-percent spacing-above-10">
						<div>
							<div th:replace="~{fragments/icons/icon-submission-success :: icon-submission-success}"></div>
						</div>
					</div>
					<div class="grid__item width-two-thirds spacing-above-10">
						<div class="margin-bottom-0">
							<div th:utext="#{next-steps.step-1}"></div>
							<div th:utext="#{next-steps.step-1-apply-once}"></div>
							<div class="text-normal" th:utext="#{next-steps.step-1-completed}"></div>
						</div>
					</div> 
				</div>
			</button>
		</div>
	
		<div class="accordion next-steps-accordion spacing-below-20">
			<button id="button-a2" href="#" class="accordion__button" aria-expanded="false" aria-controls="a2">
				<div id="process-step-2" class="grid__item width-twelve-twelfths">
					<table class="spacing-above-10 spacing-below-0" >
						<tr class="spacing-above-10">
							<th class="grid__item width-twenty-percent">
							    <div th:replace="~{fragments/icons/icon-next-steps-upload-documents :: icon-next-steps-upload-documents}"></div>
			 				</th>
			 				<th class="grid__item width-two-thirds">
								<div class="margin-bottom-0" >
									<div th:utext="#{next-steps.step-2}"></div>
									<div th:utext="#{next-steps.step-2-upload-your-documents}"></div>
								</div>
							</th>
						</tr>
					</table>
				</div>
			</button>
				<div class="accordion__content" id="a2">
					<th:block th:each="msg: ${nextStepsDocumentUpload}">
						<div class="grid-ignore-mobile">
							<p class="text-25 spacing-below-15 next-step-section" th:utext="${msg.message()}"></p>
						</div>
					</th:block>
				</div>
		</div>
	
		<div class="accordion next-steps-accordion spacing-below-20">
			<button id="button-a3" href="#" class="accordion__button" aria-expanded="false" aria-controls="a3">
				<div id="process-step-3" class="grid__item width-twelve-twelfths">
					<table class="spacing-above-10 spacing-below-0">
						<tr class="spacing-above-10">
							<th class="grid__item width-twenty-percent">
							    <div th:replace="~{fragments/icons/icon-next-steps-application-review :: icon-next-steps-application-review}"></div>
			 				</th>
			 				<th class="grid__item width-two-thirds">
								<p class="margin-bottom-0" th:utext="#{next-steps.allow-time-for-review}"></p>
							</th>
						</tr>
					</table>
				</div>
			</button>
			<div class="accordion__content" id="a3">
				<th:block th:each="msg: ${nextStepsAllowTimeForReview}">
					<div class="grid-ignore-mobile">
						<p class="text-25 spacing-below-15" th:utext="${msg.title()}"></p>
						<div class="success-icons grid__item width-one-fifth">
							<div th:replace="~{__${msg.icon()}__}" class="success-icons text--centered width-one-whole"></div>
						</div>
						<p th:if="${msg.icon()!=''}" class="grid__item  width-five-sixths next-step-section spacing-below-15" th:utext="${msg.message()}"></p>
						<p th:if="${msg.icon()==''}" class="grid__item  next-step-section spacing-below-15" th:utext="${msg.message()}"></p>
					</div>
				</th:block>
			</div>
		</div>
	
		<div class="accordion next-steps-accordion spacing-below-60">
			<button id="button-a4" href="#" class="accordion__button" aria-expanded="false" aria-controls="a4">
				<div id="process-step-4" class="grid__item width-twelve-twelfths">
					<table class="spacing-above-10 spacing-below-0">
						<tr class="spacing-above-10">
							<th class="grid__item width-twenty-percent">
							    <div th:replace="~{fragments/icons/icon-next-steps-interview :: icon-next-steps-interview}"></div>
			 				</th>
			 				<th class="grid__item width-two-thirds">
								<p class="margin-bottom-0" th:utext="#{next-steps.step-4}"></p>
							</th>
						</tr>
					</table>
				</div>
			</button>
			<div class="accordion__content" id="a4">
				<th:block th:each="msg: ${nextStepsCompleteAnInterview}">
					<div class="grid-ignore-mobile">
						<p class="text-25 spacing-below-15 next-step-section" th:utext="${msg.message()}"></p>
					</div>
				</th:block>
			</div>
		</div>
    </div>
    
  </div>
  
  <div th:replace="~{fragments/continue :: continue}"></div>
  <p class="text--green" th:if="${contactEmail != null && !contactEmail.isEmpty()}">
    <i class="icon-check_circle"></i>
    <span
        th:text="#{next-steps.your-next-steps-have-been-emailed-to(${contactEmail})}"></span>
  </p>
</div>
